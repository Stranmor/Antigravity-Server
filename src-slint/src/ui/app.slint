// Antigravity Manager - Main Application Window
// Design: Industrial Minimalism with Dark Theme

import { VerticalBox, HorizontalBox, Button, ScrollView, LineEdit, ComboBox, Switch, Slider, TabWidget } from "std-widgets.slint";
import { Dashboard } from "dashboard.slint";
import { Sidebar } from "components/sidebar.slint";
import { Theme } from "components/theme.slint";

// Global state structure
export struct DashboardStats {
    total_accounts: int,
    avg_gemini: int,
    avg_gemini_image: int,
    avg_claude: int,
    low_quota_count: int,
}

export struct CurrentAccountInfo {
    email: string,
    name: string,
    last_used: string,
    has_account: bool,
}

export component AppWindow inherits Window {
    title: "Antigravity Manager";
    min-width: 900px;
    min-height: 600px;
    background: Theme.background;
    
    // Dashboard stats properties
    in-out property <DashboardStats> stats: {
        total_accounts: 0,
        avg_gemini: 0,
        avg_gemini_image: 0,
        avg_claude: 0,
        low_quota_count: 0,
    };
    
    // Current account info
    in-out property <CurrentAccountInfo> current_account: {
        email: "",
        name: "",
        last_used: "",
        has_account: false,
    };
    
    // Current page index: 0=Dashboard, 1=Accounts, 2=API Proxy, 3=Settings, 4=Monitor
    in-out property <int> current-page: 0;
    
    // Callbacks for actions
    callback navigate(int);
    callback refresh-accounts();
    callback add-account();
    callback switch-account();
    
    navigate(page) => {
        current-page = page;
    }
    
    HorizontalBox {
        padding: 0px;
        spacing: 0px;
        
        // Left Sidebar
        Sidebar {
            width: 220px;
            current-page: root.current-page;
            navigate(page) => { root.navigate(page); }
        }
        
        // Main Content Area
        Rectangle {
            background: Theme.background;
            
            // Page content based on current-page
            if current-page == 0: Dashboard {
                width: 100%;
                height: 100%;
                stats: root.stats;
                current-account: root.current_account;
                refresh-accounts => { root.refresh-accounts(); }
                add-account => { root.add-account(); }
                switch-account => { root.switch-account(); }
            }
            
            // Placeholder for other pages
            if current-page == 1: Rectangle {
                background: Theme.background;
                Text {
                    text: "Accounts Page (Coming Soon)";
                    color: Theme.text-primary;
                    font-size: 24px;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }
            
            if current-page == 2: Rectangle {
                background: Theme.background;
                Text {
                    text: "API Proxy Page (Coming Soon)";
                    color: Theme.text-primary;
                    font-size: 24px;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }
            
            if current-page == 3: Rectangle {
                background: Theme.background;
                Text {
                    text: "Settings Page (Coming Soon)";
                    color: Theme.text-primary;
                    font-size: 24px;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }
            
            if current-page == 4: Rectangle {
                background: Theme.background;
                Text {
                    text: "Monitor Page (Coming Soon)";
                    color: Theme.text-primary;
                    font-size: 24px;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }
        }
    }
}
